# format string 0 picoCTF Write-Up

## Description
This challenge exploits a **buffer overflow** vulnerability to trigger a `SIGSEGV` handler that prints the flag. The program reads user input without length validation, opening up exploitation opportunities.

---

## Vulnerability

### 1. Buffer Overflow
- The `serve_patrick` function reads user input into the `choice1` buffer, which is 32 bytes in size, without checking the input length.
- Code example:
  ```c
  #define BUFSIZE 32

  char choice1[BUFSIZE];
  scanf("%s", choice1);
  ```
- Input longer than 32 characters causes a **buffer overflow**, which can corrupt memory and trigger a segmentation fault.

### 2. SIGSEGV Handler
- When a segmentation fault occurs, the custom `sigsegv_handler` will print the contents of the `flag` buffer:
  ```c
  void sigsegv_handler(int sig) {
      printf("\n%s\n", flag);
      exit(1);
  }
  ```
- By exploiting the buffer overflow, this handler can be triggered to print the flag stored in the `flag.txt` file.

---

## Exploitation

1. **Insert Payload**:
   - Send a string longer than 32 characters to trigger the buffer overflow.
   - Example payload:
     ```
     AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
     ```

2. **Trigger Segmentation Fault**:
   - The buffer overflow corrupts memory and causes a segmentation fault.

3. **Handler Prints Flag**:
   - When the segmentation fault occurs, the `SIGSEGV` handler prints the contents of the `flag` buffer.

---

## Flag
After successful exploitation, the program prints the following flag
```
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_c8362f05}
```
